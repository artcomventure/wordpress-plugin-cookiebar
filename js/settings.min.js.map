{"version":3,"sources":["settings.js"],"names":["$","each","$this","$tabs","on","e","preventDefault","removeClass","attr","hide","blur","addClass","show","find","first","trigger","$messages","document","getElementsByClassName","setEditorStyle","css","selector","tinymce","_css","attribute","hasOwnProperty","push","join","Array","prototype","forEach","call","$message","editor","get","id","$body","getBody","dom","setStyle","parent","append","$fontSizeInput","$handle","checked","fontSize","val","slider","min","max","value","parseInt","create","event","ui","children","slide","wpColorPicker","palettes","change","data","setTimeout","name","backgroundColor","color","bind","closest","text","$buttonColorUI","$tagInputs","filter","length","$expires","$display","request","setDescription","abort","ajaxurl","action","expires","format","response","wp","i18n","__","html","jQuery"],"mappings":";;AAAA,CAAC,UAAWA,CAAX,EAAe;AAMZA,EAAAA,CAAC,CAAE,qBAAF,CAAD,CAA2BC,IAA3B,CAAiC,YAAY;AACzC,QAAMC,KAAK,GAAGF,CAAC,CAAE,IAAF,CAAf;AAAA,QACIG,KAAK,GAAGH,CAAC,CAAE,GAAF,EAAOE,KAAP,CAAD,CAAgBE,EAAhB,CAAoB,OAApB,EAA6B,UAAWC,CAAX,EAAe;AAChDA,MAAAA,CAAC,CAACC,cAAF;AAGAH,MAAAA,KAAK,CAACI,WAAN,CAAmB,gBAAnB,EAAsCN,IAAtC,CAA4C,YAAY;AAEpDD,QAAAA,CAAC,CAAEA,CAAC,CAAE,IAAF,CAAD,CAAUQ,IAAV,CAAgB,MAAhB,CAAF,CAAD,CAA8BC,IAA9B;AACH,OAHD;AAMAT,MAAAA,CAAC,CAAEA,CAAC,CAAE,IAAF,CAAD,CAAUU,IAAV,GAAiBC,QAAjB,CAA2B,gBAA3B,EAA8CH,IAA9C,CAAoD,MAApD,CAAF,CAAD,CAAkEI,IAAlE;AACH,KAXO,CADZ;AAeAV,IAAAA,KAAK,CAACW,IAAN,CAAY,GAAZ,EAAkBC,KAAlB,GAA0BC,OAA1B,CAAmC,OAAnC;AACH,GAjBD;AAuBA,MAAMC,SAAS,GAAGC,QAAQ,CAACC,sBAAT,CAAiC,gBAAjC,CAAlB;;AACA,WAASC,cAAT,CAAyBC,GAAzB,EAA8BC,QAA9B,EAAyC;AACrC,QAAK,OAAOC,OAAP,KAAmB,WAAxB,EAAsC;AACtC,QAAK,OAAOD,QAAP,KAAoB,WAAzB,EAAuCA,QAAQ,GAAG,MAAX;;AAGvC,QAAKA,QAAQ,KAAK,MAAlB,EAA2B;AACvB,UAAIE,IAAI,GAAG,EAAX;;AAEA,WAAM,IAAIC,SAAV,IAAuBJ,GAAvB,EAA6B;AACzB,YAAK,CAACA,GAAG,CAACK,cAAJ,CAAoBD,SAApB,CAAN,EAAwC;;AACxCD,QAAAA,IAAI,CAACG,IAAL,CAAWF,SAAS,GAAG,IAAZ,GAAmBJ,GAAG,CAACI,SAAD,CAAjC;AACH;;AAEDJ,MAAAA,GAAG,GAAG,YAAYC,QAAZ,GAAuB,IAAvB,GAA8BE,IAAI,CAACI,IAAL,CAAW,IAAX,CAA9B,GAAkD,YAAxD;AACH;;AAEDC,IAAAA,KAAK,CAACC,SAAN,CAAgBC,OAAhB,CAAwBC,IAAxB,CAA8Bf,SAA9B,EAAyC,UAAUgB,QAAV,EAAqB;AAC1D,UAAMC,MAAM,GAAGX,OAAO,CAACY,GAAR,CAAaF,QAAQ,CAACG,EAAtB,CAAf;AAAA,UACIC,KAAK,GAAGH,MAAM,CAACI,OAAP,EADZ;AAGA,UAAKhB,QAAQ,KAAK,MAAlB,EAA2BY,MAAM,CAACK,GAAP,CAAWC,QAAX,CAAqBH,KAArB,EAA4BhB,GAA5B,EAA3B,KACKpB,CAAC,CAACoC,KAAD,CAAD,CAASI,MAAT,GAAkB3B,IAAlB,CAAwB,MAAxB,EAAiC4B,MAAjC,CAAyCrB,GAAzC;AACR,KAND;AAOH;;AAMD,MAAMsB,cAAc,GAAG1C,CAAC,CAAE,6BAAF,CAAxB;AACA,MAAI2C,OAAJ;AAEA3C,EAAAA,CAAC,CAAE,kBAAF,CAAD,CAAwBI,EAAxB,CAA4B,QAA5B,EAAsC,YAAW;AAC7CJ,IAAAA,CAAC,CAAC,IAAD,CAAD,CAAQwC,MAAR,GAAiB,KAAKI,OAAL,GAAe,UAAf,GAA4B,aAA7C,EAA6D,SAA7D;AAEA,QAAK,KAAKA,OAAV,EAAoBzB,cAAc,CAAE;AAAE0B,MAAAA,QAAQ,EAAEH,cAAc,CAACI,GAAf,MAAsBJ,cAAc,CAAClC,IAAf,CAAqB,aAArB;AAAlC,KAAF,CAAd,CAApB,KACKW,cAAc,CAAE;AAAE0B,MAAAA,QAAQ,EAAE;AAAZ,KAAF,CAAd;AACR,GALD,EAKI9B,OALJ,CAKa,QALb;AAOAf,EAAAA,CAAC,CAAE,mBAAF,CAAD,CAAyB+C,MAAzB,CAAiC;AAC7BC,IAAAA,GAAG,EAAE,CADwB;AAE7BC,IAAAA,GAAG,EAAE,EAFwB;AAG7BC,IAAAA,KAAK,EAAEC,QAAQ,CAACT,cAAc,CAACI,GAAf,MAAsBJ,cAAc,CAAClC,IAAf,CAAqB,aAArB,CAAvB,CAHc;AAI7B4C,IAAAA,MAAM,EAAE,gBAAUC,KAAV,EAAiBC,EAAjB,EAAsB;AAC1BX,MAAAA,OAAO,GAAG3C,CAAC,CAAC,IAAD,CAAD,CAAQuD,QAAR,GAAmBzC,KAAnB,GAA2BN,IAA3B,CAAiC,YAAjC,EAA+CkC,cAAc,CAACI,GAAf,MAAsBJ,cAAc,CAAClC,IAAf,CAAqB,aAArB,CAArE,CAAV;AACH,KAN4B;AAO7BgD,IAAAA,KAAK,EAAE,eAAUH,KAAV,EAAiBC,EAAjB,EAAqBJ,KAArB,EAA6B;AAChCR,MAAAA,cAAc,CAACI,GAAf,CAAoBI,KAAK,GAAGI,EAAE,CAACJ,KAAH,GAAW,IAAvC;AACAP,MAAAA,OAAO,CAACnC,IAAR,CAAc,YAAd,EAA4B0C,KAA5B;AACA/B,MAAAA,cAAc,CAAE;AAAE0B,QAAAA,QAAQ,EAAEK;AAAZ,OAAF,CAAd;AACH;AAX4B,GAAjC;AAkBAlD,EAAAA,CAAC,CAAE,oBAAF,CAAD,CAA0BC,IAA1B,CAAgC,YAAW;AACvCD,IAAAA,CAAC,CAAC,IAAD,CAAD,CAAQyD,aAAR,CAAuB;AACnBC,MAAAA,QAAQ,EAAE,EADS;AAEnBC,MAAAA,MAAM,EAAE,gBAAUtD,CAAV,EAAauD,IAAb,EAAoB;AACxBC,QAAAA,UAAU,CAAE,YAAW;AACnB,kBAAS,KAAKC,IAAd;AACI,iBAAK,iBAAL;AACI3C,cAAAA,cAAc,CAAE;AAAE4C,gBAAAA,eAAe,EAAE,KAAKb;AAAxB,eAAF,CAAd;AACA;;AAEJ,iBAAK,kBAAL;AACI/B,cAAAA,cAAc,CAAE;AAAE6C,gBAAAA,KAAK,EAAE,KAAKd;AAAd,eAAF,CAAd;AACA;;AAEJ,iBAAK,kBAAL;AACI/B,cAAAA,cAAc,CAAE;AAAE6C,gBAAAA,KAAK,EAAE,KAAKd;AAAd,eAAF,EAAyB,GAAzB,CAAd;AACA;AAXR;AAaH,SAdW,CAcVe,IAdU,CAcJ,IAdI,CAAF,EAcM,EAdN,CAAV;AAeH;AAlBkB,KAAvB,EAqBCC,OArBD,CAqBU,yBArBV,EAqBsCrD,IArBtC,CAqB4C,2BArB5C,EAqB0EsD,IArB1E,CAqBgFnE,CAAC,CAAC,IAAD,CAAD,CAAQ4D,IAAR,CAAc,OAAd,CArBhF;AAsBH,GAvBD;AAgCA,MAAMQ,cAAc,GAAGpE,CAAC,CAAE,kCAAF,CAAD,CAAwCkE,OAAxC,CAAiD,yBAAjD,CAAvB;AAAA,MACIG,UAAU,GAAGrE,CAAC,CAAE,2EAAF,CAAD,CAAiFI,EAAjF,CAAqF,QAArF,EAA+F,YAAW;AACnH,QAAM0D,IAAI,GAAG,KAAKA,IAAlB;AACA,QAAMZ,KAAK,GAAG,KAAKA,KAAnB;AAEAmB,IAAAA,UAAU,CAACC,MAAX,CAAmB,YAAW;AAC1B,aAAO,KAAKR,IAAL,KAAcA,IAArB;AACH,KAFD,EAEI7D,IAFJ,CAEU,YAAW;AAAED,MAAAA,CAAC,CAAC,IAAD,CAAD,CAAQ8C,GAAR,CAAaI,KAAb;AAAuB,KAF9C;AAMAkB,IAAAA,cAAc,CAACC,UAAU,CAACC,MAAX,CAAmB,YAAW;AAAE,aAAO,KAAKpB,KAAL,KAAe,QAAtB;AAAgC,KAAhE,EAAmEqB,MAAnE,GAA6E,MAA7E,GAAsF,MAAvF,CAAd;AACH,GAXY,CADjB;AAeIF,EAAAA,UAAU,CAACvD,KAAX,GAAmBC,OAAnB,CAA4B,QAA5B;;AAMJ,GAAC,YAAW;AAER,QAAMyD,QAAQ,GAAGxE,CAAC,CAAE,4BAAF,CAAlB;AACA,QAAK,CAACwE,QAAQ,CAACD,MAAf,EAAwB;AAExB,QAAME,QAAQ,GAAGD,QAAQ,CAAC3D,IAAT,CAAe,oCAAf,CAAjB;AACA,QAAK,CAAC4D,QAAQ,CAACF,MAAf,EAAwB;AAExB,QAAIG,OAAJ;;AAEA,aAASC,cAAT,GAA0B;AACtB,UAAKD,OAAL,EAAeA,OAAO,GAAGA,OAAO,CAACE,KAAR,EAAV;AAEfF,MAAAA,OAAO,GAAG1E,CAAC,CAACkC,GAAF,CAAO2C,OAAP,EAAgB;AACtBC,QAAAA,MAAM,EAAE,gBADc;AAEtBC,QAAAA,OAAO,EAAEP,QAAQ,CAAC1B,GAAT,EAFa;AAGtBkC,QAAAA,MAAM,EAAE;AAHc,OAAhB,EAIP,UAAWC,QAAX,EAAsB;AACrBR,QAAAA,QAAQ,CAAClE,WAAT,CAAsB,OAAtB;;AAEA,YAAK0E,QAAQ,KAAK,KAAlB,EAA0B;AACtBA,UAAAA,QAAQ,GAAGC,EAAE,CAACC,IAAH,CAAQC,EAAR,CAAY,6BAAZ,EAA2C,KAA3C,CAAX;AACAX,UAAAA,QAAQ,CAAC9D,QAAT,CAAmB,OAAnB;AACH,SAHD,MAIK,IAAK,CAACsE,QAAN,EAAiBA,QAAQ,GAAGC,EAAE,CAACC,IAAH,CAAQC,EAAR,CAAY,8BAAZ,EAA4C,KAA5C,CAAX;;AAEtBX,QAAAA,QAAQ,CAACY,IAAT,CAAeJ,QAAf;AACH,OAdS,CAAV;AAeH;;AAEDT,IAAAA,QAAQ,CAACpE,EAAT,CAAa,OAAb,EAAsBuE,cAAtB;AAEH,GAhCD;AAkCH,CA9KD,EA8KIW,MA9KJ","sourcesContent":["(function ( $ ) {\n\n    /**\n     * T9n tabs.\n     */\n\n    $( 'div.nav-tab-wrapper' ).each( function () {\n        const $this = $( this ),\n            $tabs = $( 'a', $this ).on( 'click', function ( e ) {\n                e.preventDefault();\n\n                // deselect\n                $tabs.removeClass( 'nav-tab-active' ).each( function () {\n                    // hide all sections\n                    $( $( this ).attr( 'href' ) ).hide();\n                } );\n\n                // activate clicked section\n                $( $( this ).blur().addClass( 'nav-tab-active' ).attr( 'href' ) ).show();\n            } );\n\n        // activate first tab\n        $this.find( 'a' ).first().trigger( 'click' );\n    } );\n\n    /**\n     * Change editor styles.\n     */\n\n    const $messages = document.getElementsByClassName( 'wp-editor-area' );\n    function setEditorStyle( css, selector ) {\n        if ( typeof tinymce === 'undefined' ) return;\n        if ( typeof selector === 'undefined' ) selector = 'body';\n\n        // need <style>\n        if ( selector !== 'body' ) {\n            let _css = [];\n\n            for ( let attribute in css ) {\n                if ( !css.hasOwnProperty( attribute ) ) continue;\n                _css.push( attribute + ': ' + css[attribute] );\n            }\n\n            css = '<style>' + selector + '{ ' + _css.join( '; ' ) + ' }</style>';\n        }\n\n        Array.prototype.forEach.call( $messages, function( $message ) {\n            const editor = tinymce.get( $message.id ),\n                $body = editor.getBody();\n\n            if ( selector === 'body' ) editor.dom.setStyle( $body, css );\n            else $($body).parent().find( 'head' ).append( css );\n        } );\n    }\n\n    /**\n     * Font size range slider.\n     */\n\n    const $fontSizeInput = $( 'input[name=\"sid[fontsize]\"]' );\n    let $handle;\n\n    $( '#custom_fontsize' ).on( 'change', function() {\n        $(this).parent()[this.checked ? 'addClass' : 'removeClass']( 'checked' );\n\n        if ( this.checked ) setEditorStyle( { fontSize: $fontSizeInput.val()||$fontSizeInput.attr( 'placeholder' ) } );\n        else setEditorStyle( { fontSize: '' } );\n    } ).trigger( 'change' );\n\n    $( '#font-size-slider' ).slider( {\n        min: 8,\n        max: 36,\n        value: parseInt($fontSizeInput.val()||$fontSizeInput.attr( 'placeholder' ) ),\n        create: function( event, ui ) {\n            $handle = $(this).children().first().attr( 'data-value', $fontSizeInput.val()||$fontSizeInput.attr( 'placeholder' ) );\n        },\n        slide: function( event, ui, value ) {\n            $fontSizeInput.val( value = ui.value + 'px' );\n            $handle.attr( 'data-value', value );\n            setEditorStyle( { fontSize: value } )\n        }\n    } );\n\n    /**\n     * Color picker UI.\n     */\n\n    $( 'input.color-picker' ).each( function() {\n        $(this).wpColorPicker( {\n            palettes: [],\n            change: function( e, data ) {\n                setTimeout( function() {\n                    switch ( this.name ) {\n                        case 'sid[color][box]':\n                            setEditorStyle( { backgroundColor: this.value } );\n                            break;\n\n                        case 'sid[color][text]':\n                            setEditorStyle( { color: this.value } );\n                            break;\n\n                        case 'sid[color][link]':\n                            setEditorStyle( { color: this.value }, 'a' );\n                            break;\n                    }\n                }.bind( this ), 10 );\n            }\n        } )\n        // change label\n        .closest( 'div.wp-picker-container' ).find( 'span.wp-color-result-text' ).text( $(this).data( 'label' ) );\n    } );\n\n    /**\n     * Connect confirmation tag inputs.\n     *\n     * This field is in t9n section although it's an unique value.\n     * Therefore: when one is changed all others are changed (for UX purpose).\n     */\n\n    const $buttonColorUI = $( 'input[name=\"sid[color][button]\"]' ).closest( 'div.wp-picker-container' ),\n        $tagInputs = $( 'select[name=\"sid[rejection][tag]\"], select[name=\"sid[confirmation][tag]\"]' ).on( 'change', function() {\n            const name = this.name;\n            const value = this.value;\n\n            $tagInputs.filter( function() {\n                return this.name === name;\n            } ).each( function() { $(this).val( value ); } );\n\n            // toggle button color UI\n            // not needed for button `tag`.\n            $buttonColorUI[$tagInputs.filter( function() { return this.value === 'button' } ).length  ? 'show' : 'hide']()\n        } );\n\n        // to toggle button color UI on page load\n        $tagInputs.first().trigger( 'change' );\n\n    /**\n     * Set expiration.\n     */\n\n    (function() {\n\n        const $expires = $( 'input[name=\"sid[expires]\"]' );\n        if ( !$expires.length ) return;\n\n        const $display = $expires.find( '+ p.description span:first-of-type' );\n        if ( !$display.length ) return;\n\n        let request;\n\n        function setDescription() {\n            if ( request ) request = request.abort();\n\n            request = $.get( ajaxurl, {\n                action: 'sid-expiration',\n                expires: $expires.val(),\n                format: 'd.m.Y H:i:s'\n            }, function ( response ) {\n                $display.removeClass( 'error' );\n\n                if ( response === false ) {\n                    response = wp.i18n.__( 'ERROR. Please check format.', 'sid' );\n                    $display.addClass( 'error' );\n                }\n                else if ( !response ) response = wp.i18n.__( 'until the end of the session', 'sid' );\n\n                $display.html( response )\n            } );\n        }\n\n        $expires.on( 'input', setDescription );\n\n    })();\n\n})( jQuery );"],"file":"settings.min.js"}